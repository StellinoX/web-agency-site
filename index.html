<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Etraweb Web Agency | Siti Web Premium</title>
    <meta name="description"
        content="Creiamo esperienze digitali straordinarie. La migliore web agency per il tuo business.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Space+Grotesk:wght@300;500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <!-- Import Map for Three.js Modules -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>
</head>

<body>
    <!-- Preloader -->
    <div id="preloader">
        <div class="loader-content">
            <div class="loader-text">INITIALIZING SYSTEM...</div>
            <div class="loader-bar">
                <div class="loader-progress"></div>
            </div>
        </div>
    </div>

    <div class="cursor-dot" data-cursor-dot></div>
    <div class="cursor-outline" data-cursor-outline></div>

    <canvas id="bg-canvas"></canvas>

    <header class="header">
        <div class="container header-container">
            <a href="#" class="logo">ETRAWEB<span class="dot">.</span></a>
            <nav class="nav">
                <ul class="nav-list">
                    <li><a href="#hero" class="nav-link" data-i18n="nav_home">Home</a></li>
                    <li><a href="#services" class="nav-link" data-i18n="nav_services">Servizi</a></li>
                    <li><a href="#portfolio" class="nav-link" data-i18n="nav_portfolio">Portfolio</a></li>
                    <li><a href="#contact" class="nav-link btn-primary" data-i18n="nav_contact">Contattaci</a></li>
                    <li>
                        <div class="lang-switch">
                            <button class="lang-btn active" data-lang="it">IT</button>
                            <span class="lang-separator">|</span>
                            <button class="lang-btn" data-lang="en">EN</button>
                        </div>
                    </li>
                </ul>
                <button class="mobile-menu-btn" aria-label="Menu">
                    <span></span>
                    <span></span>
                </button>
            </nav>
        </div>
    </header>

    <main>
        <section id="hero" class="hero">
            <div class="hero-bg-elements">
                <div class="orb orb-1"></div>
                <div class="orb orb-2"></div>
                <div class="orb orb-3"></div>
                <div class="orb orb-4"></div>
            </div>
            <div class="container hero-content">
                <h1 class="hero-title reveal-text" data-i18n="hero_title">
                    Eleviamo la tua <br>
                    <span class="gradient-text">Presenza Digitale</span>
                </h1>
                <p class="hero-subtitle reveal-text" style="transition-delay: 0.2s;" data-i18n="hero_subtitle">
                    Creiamo siti web che non sono solo pagine, ma esperienze immersive. Design futuristico, prestazioni
                    estreme.
                </p>
                <div class="hero-cta reveal-text" style="transition-delay: 0.4s;">
                    <a href="#contact" class="btn-glow" data-i18n="hero_cta_start">Inizia il Progetto</a>
                    <a href="#portfolio" class="btn-outline" data-i18n="hero_cta_works">Vedi i Lavori</a>
                </div>
            </div>
            <div class="scroll-indicator">
                <span>Scroll</span>
                <div class="mouse"></div>
            </div>
        </section>

        <!-- Infinite Marquee -->
        <div class="marquee-container">
            <div class="marquee-content">
                <span>CREATIVE STRATEGY ‚Ä¢ WEB DEVELOPMENT ‚Ä¢ UI/UX DESIGN ‚Ä¢ BRAND IDENTITY ‚Ä¢ DIGITAL EXPERIENCES ‚Ä¢</span>
                <span>CREATIVE STRATEGY ‚Ä¢ WEB DEVELOPMENT ‚Ä¢ UI/UX DESIGN ‚Ä¢ BRAND IDENTITY ‚Ä¢ DIGITAL EXPERIENCES ‚Ä¢</span>
            </div>
        </div>

        <!-- About & Stats Section -->
        <section id="about" class="about section-padding">
            <div class="container">
                <div class="about-grid">
                    <div class="about-text">
                        <h2 class="section-title" data-i18n="about_title">Il Nostro DNA</h2>
                        <p class="section-desc" data-i18n="about_desc_1">Siamo un collettivo di visionari digitali. Non
                            seguiamo i trend, li
                            creiamo. La nostra missione √® trasformare idee complesse in esperienze digitali fluide e
                            memorabili.</p>
                        <p class="section-desc" style="margin-top: 1rem;" data-i18n="about_desc_2">Ogni pixel √®
                            posizionato con intenzione, ogni
                            animazione racconta una storia.</p>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-item glass-card">
                            <div class="stat-number" data-target="10">0</div>
                            <div class="stat-label" data-i18n="stats_projects">Tecnologie Padroneggiate</div>
                        </div>
                        <div class="stat-item glass-card">
                            <div class="stat-number" data-target="2">0</div>
                            <div class="stat-label" data-i18n="stats_awards">Piattaforme Mobile</div>
                        </div>
                        <div class="stat-item glass-card">
                            <div class="stat-number" data-target="100">0</div>
                            <div class="stat-label" data-i18n="stats_clients">% Dedizione</div>
                        </div>
                        <div class="stat-item glass-card">
                            <div class="stat-number" data-target="24">0</div>
                            <div class="stat-label" data-i18n="stats_support">h Supporto</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="services" class="services section-padding">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title" data-i18n="services_title">I Nostri Servizi</h2>
                    <p class="section-desc" data-i18n="services_desc">Eccellenza tecnica e creativa per il tuo brand.
                    </p>
                </div>
                <div class="services-grid">
                    <div class="service-card glass-card">
                        <div class="service-icon">‚ú®</div>
                        <h3 data-i18n="service_1_title">Web Design Premium</h3>
                        <p data-i18n="service_1_desc">Interfacce utente mozzafiato progettate per catturare l'attenzione
                            e convertire i visitatori.
                        </p>
                    </div>
                    <div class="service-card glass-card">
                        <div class="service-icon">üöÄ</div>
                        <h3 data-i18n="service_2_title">Sviluppo Frontend</h3>
                        <p data-i18n="service_2_desc">Codice pulito, veloce e ottimizzato SEO. Animazioni fluide e
                            interattivit√† avanzata.</p>
                    </div>
                    <div class="service-card glass-card">
                        <div class="service-icon">üì±</div>
                        <h3 data-i18n="service_3_title">Responsive & Mobile</h3>
                        <p data-i18n="service_3_desc">Esperienza perfetta su ogni dispositivo, dal desktop allo
                            smartphone.</p>
                    </div>
                    <div class="service-card glass-card">
                        <div class="service-icon">‚ö°</div>
                        <h3 data-i18n="service_4_title">Ottimizzazione Performance</h3>
                        <p data-i18n="service_4_desc">Tempi di caricamento istantanei per non perdere nemmeno un
                            cliente.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Process Section -->
        <section id="process" class="process section-padding">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title" data-i18n="process_title">Come Lavoriamo</h2>
                    <p class="section-desc" data-i18n="process_desc">Un processo collaudato per risultati eccezionali.
                    </p>
                </div>
                <div class="process-grid">
                    <div class="process-step glass-card">
                        <div class="step-number">01</div>
                        <h3 data-i18n="process_1_title">Discovery</h3>
                        <p data-i18n="process_1_desc">Analizziamo il tuo brand, i tuoi obiettivi e il tuo pubblico per
                            definire una strategia
                            vincente.</p>
                    </div>
                    <div class="process-step glass-card">
                        <div class="step-number">02</div>
                        <h3 data-i18n="process_2_title">Creation</h3>
                        <p data-i18n="process_2_desc">Diamo vita al design con prototipi interattivi e scriviamo codice
                            pulito e performante.</p>
                    </div>
                    <div class="process-step glass-card">
                        <div class="step-number">03</div>
                        <h3 data-i18n="process_3_title">Launch</h3>
                        <p data-i18n="process_3_desc">Testiamo tutto rigorosamente e lanciamo il tuo sito verso il
                            successo digitale.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="portfolio" class="portfolio section-padding">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title" data-i18n="portfolio_title">Selected Works</h2>
                    <p class="section-desc" data-i18n="portfolio_desc">Alcuni dei nostri progetti pi√π recenti.</p>
                </div>
                <div class="portfolio-showcase">
                    <!-- Placeholder for portfolio items - will be populated or static -->
                    <div class="portfolio-item"
                        onclick="window.open('https://foxindustrialcontractingsrl.com/', '_blank')">
                        <img src="images/Fox Industrial Contracting S.r.l..jpeg" alt="Fox Industrial Contracting"
                            class="portfolio-image">
                        <div class="portfolio-info">
                            <h3>Fox Industrial Contracting</h3>
                            <p data-i18n="portfolio_1_cat">Industrial Services</p>
                        </div>
                    </div>
                    <div class="portfolio-item" onclick="window.open('NEON_cocktail/index.html', '_blank')">
                        <img src="images/neon-cover.png" alt="NEON Cocktail Bar" class="portfolio-image">
                        <div class="portfolio-info">
                            <h3>NEON Cocktail Bar</h3>
                            <p data-i18n="portfolio_2_cat">Sito Web Cocktail Bar</p>
                        </div>
                    </div>
                    <div class="portfolio-item">
                        <div class="portfolio-image placeholder-gradient-3"></div>
                        <div class="portfolio-info">
                            <h3>Cyber Finance</h3>
                            <p data-i18n="portfolio_3_cat">Fintech App Landing</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="contact" class="contact section-padding">
            <div class="container">
                <div class="contact-wrapper glass-card">
                    <div class="contact-content">
                        <h2 class="section-title" data-i18n="contact_title">Parliamo del tuo Futuro</h2>
                        <p data-i18n="contact_desc">Pronto a trasformare la tua visione in realt√†? Compila il form e ti
                            risponderemo entro 24
                            ore.</p>
                        <ul class="contact-details">
                            <li>assistenza@etraweb.com</li>
                        </ul>
                    </div>
                    <form class="contact-form" action="https://api.web3forms.com/submit" method="POST">
                        <input type="hidden" name="access_key" value="408d6773-505d-4c2a-962d-5294dc95099e">
                        <div class="form-group">
                            <input type="text" id="name" name="name" required placeholder=" ">
                            <label for="name" data-i18n="contact_name">Nome</label>
                        </div>
                        <div class="form-group">
                            <input type="email" id="email" name="email" required placeholder=" ">
                            <label for="email" data-i18n="contact_email">Email</label>
                        </div>
                        <div class="form-group">
                            <textarea id="message" name="message" required placeholder=" " rows="4"></textarea>
                            <label for="message" data-i18n="contact_message">Messaggio</label>
                        </div>
                        <button type="submit" class="btn-glow full-width" data-i18n="contact_submit">Invia
                            Richiesta</button>
                    </form>
                </div>
            </div>
        </section>
    </main>

    <!-- Monumental Footer -->
    <footer>
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <h2>ETRAWEB</h2>
                    <p data-i18n="footer_desc">Creiamo esperienze digitali che definiscono il futuro. Design, tecnologia
                        e strategia fusi in
                        un'unica entit√†.</p>
                    <a href="#contact" class="cta-button-footer" data-i18n="footer_cta">Inizia un Progetto</a>
                </div>
                <div class="footer-col">
                    <h4 data-i18n="footer_studio">Studio</h4>
                    <ul class="footer-links">
                        <li><a href="#about" data-i18n="footer_link_about">Chi Siamo</a></li>
                        <li><a href="#process" data-i18n="footer_link_method">Il Nostro Metodo</a></li>
                        <li><a href="#portfolio" data-i18n="footer_link_works">Lavori</a></li>
                        <li><a href="#" data-i18n="footer_link_careers">Carriere</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4 data-i18n="footer_services">Servizi</h4>
                    <ul class="footer-links">
                        <li><a href="#services" data-i18n="footer_link_web">Web Design</a></li>
                        <li><a href="#services" data-i18n="footer_link_frontend">Sviluppo Frontend</a></li>
                        <li><a href="#services" data-i18n="footer_link_ecommerce">E-Commerce</a></li>
                        <li><a href="#services" data-i18n="footer_link_branding">Branding</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Social</h4>
                    <ul class="footer-links">
                        <li><a href="https://instagram.com/etra.web" target="_blank">Instagram</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Etraweb Digital Agency. All rights reserved.</p>
                <div class="social-links">
                    <a href="https://instagram.com/etra.web" class="social-icon instagram-btn"
                        target="_blank">Instagram</a>

                </div>
            </div>
        </div>
    </footer>

    <script type="module">
        import * as THREE from 'three';
        import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
        import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
        import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';
        // import translations from './translations.js'; // Commented out to avoid CORS on local file opening

        const translations = {
            it: {
                nav_home: "Home",
                nav_services: "Servizi",
                nav_portfolio: "Portfolio",
                nav_contact: "Contattaci",

                hero_title: "Eleviamo la tua <br> <span class=\"gradient-text\">Presenza Digitale</span>",
                hero_subtitle: "Creiamo siti web e app che non sono solo pagine, ma esperienze immersive. Design futuristico, prestazioni estreme.",
                hero_cta_start: "Inizia il Progetto",
                hero_cta_works: "Vedi i Concept",

                about_title: "Il Nostro DNA",
                about_desc_1: "Siamo un collettivo di visionari digitali. Non seguiamo i trend, li creiamo. La nostra missione √® trasformare idee complesse in esperienze digitali fluide e memorabili.",
                about_desc_2: "Dal web alle app mobile, ogni pixel √® posizionato con intenzione, ogni animazione racconta una storia.",

                stats_projects: "Tecnologie Padroneggiate",
                stats_awards: "Piattaforme Mobile",
                stats_clients: "% Dedizione",
                stats_support: "h Supporto",

                services_title: "I Nostri Servizi",
                services_desc: "Eccellenza tecnica e creativa per il tuo brand, su ogni schermo.",

                service_1_title: "Web Design Premium",
                service_1_desc: "Interfacce utente mozzafiato progettate per catturare l'attenzione e convertire i visitatori.",
                service_2_title: "Sviluppo Frontend",
                service_2_desc: "Codice pulito, veloce e ottimizzato SEO. Animazioni fluide e interattivit√† avanzata.",
                service_3_title: "Sviluppo App Mobile",
                service_3_desc: "App native per iOS e Android. Prestazioni elevate e user experience nativa impeccabile.",
                service_4_title: "Ottimizzazione Performance",
                service_4_desc: "Tempi di caricamento istantanei per non perdere nemmeno un cliente.",

                process_title: "Come Lavoriamo",
                process_desc: "Un processo collaudato per risultati eccezionali.",

                process_1_title: "Discovery",
                process_1_desc: "Analizziamo il tuo brand, i tuoi obiettivi e il tuo pubblico per definire una strategia vincente.",
                process_2_title: "Creation",
                process_2_desc: "Diamo vita al design con prototipi interattivi e scriviamo codice pulito e performante.",
                process_3_title: "Launch",
                process_3_desc: "Testiamo tutto rigorosamente e lanciamo il tuo sito verso il successo digitale.",

                portfolio_title: "Project Showcase",
                portfolio_desc: "Esempi di ci√≤ che possiamo realizzare per te.",
                portfolio_1_cat: "Industrial Services",
                portfolio_2_cat: "Sito Web Cocktail Bar",
                portfolio_3_cat: "Fintech App Landing",

                contact_title: "Parliamo del tuo Futuro",
                contact_desc: "Pronto a trasformare la tua visione in realt√†? Compila il form e ti risponderemo entro 24 ore.",
                contact_name: "Nome",
                contact_email: "Email",
                contact_message: "Messaggio",
                contact_submit: "Invia Richiesta",

                footer_desc: "Creiamo esperienze digitali che definiscono il futuro. Design, tecnologia e strategia fusi in un'unica entit√†.",
                footer_cta: "Inizia un Progetto",
                footer_studio: "Studio",
                footer_link_about: "Chi Siamo",
                footer_link_method: "Il Nostro Metodo",
                footer_link_works: "Showcase",
                footer_link_careers: "Carriere",
                footer_services: "Servizi",
                footer_link_web: "Web Design",
                footer_link_frontend: "Sviluppo App",
                footer_link_ecommerce: "E-Commerce",
                footer_link_branding: "Branding"
            },
            en: {
                nav_home: "Home",
                nav_services: "Services",
                nav_portfolio: "Showcase",
                nav_contact: "Contact Us",

                hero_title: "We Elevate Your <br> <span class=\"gradient-text\">Digital Presence</span>",
                hero_subtitle: "We create websites and apps that are not just pages, but immersive experiences. Futuristic design, extreme performance.",
                hero_cta_start: "Start Project",
                hero_cta_works: "View Concepts",

                about_title: "Our DNA",
                about_desc_1: "We are a collective of digital visionaries. We don't follow trends, we create them. Our mission is to transform complex ideas into fluid and memorable digital experiences.",
                about_desc_2: "From web to mobile apps, every pixel is placed with intention, every animation tells a story.",

                stats_projects: "Technologies Mastered",
                stats_awards: "Mobile Platforms",
                stats_clients: "% Dedication",
                stats_support: "h Support",

                services_title: "Our Services",
                services_desc: "Technical and creative excellence for your brand, on every screen.",

                service_1_title: "Premium Web Design",
                service_1_desc: "Breathtaking user interfaces designed to capture attention and convert visitors.",
                service_2_title: "Frontend Development",
                service_2_desc: "Clean, fast, and SEO-optimized code. Smooth animations and advanced interactivity.",
                service_3_title: "Mobile App Development",
                service_3_desc: "Native apps for iOS and Android. High performance and flawless native user experience.",
                service_4_title: "Performance Optimization",
                service_4_desc: "Instant load times so you don't lose a single customer.",

                process_title: "How We Work",
                process_desc: "A proven process for exceptional results.",

                process_1_title: "Discovery",
                process_1_desc: "We analyze your brand, your goals, and your audience to define a winning strategy.",
                process_2_title: "Creation",
                process_2_desc: "We bring the design to life with interactive prototypes and write clean, performant code.",
                process_3_title: "Launch",
                process_3_desc: "We rigorously test everything and launch your site towards digital success.",

                portfolio_title: "Project Showcase",
                portfolio_desc: "Examples of what we can build for you.",
                portfolio_1_cat: "Industrial Services",
                portfolio_2_cat: "Cocktail Bar Website",
                portfolio_3_cat: "Fintech App Landing",

                contact_title: "Let's Talk About Your Future",
                contact_desc: "Ready to transform your vision into reality? Fill out the form and we will reply within 24 hours.",
                contact_name: "Name",
                contact_email: "Email",
                contact_message: "Message",
                contact_submit: "Send Request",

                footer_desc: "We create digital experiences that define the future. Design, technology, and strategy fused into a single entity.",
                footer_cta: "Start a Project",
                footer_studio: "Studio",
                footer_link_about: "About Us",
                footer_link_method: "Our Method",
                footer_link_works: "Showcase",
                footer_link_careers: "Careers",
                footer_services: "Services",
                footer_link_web: "Web Design",
                footer_link_frontend: "App Dev",
                footer_link_ecommerce: "E-Commerce",
                footer_link_branding: "Branding"
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            // --- LANGUAGE SWITCHER ---
            const langBtns = document.querySelectorAll('.lang-btn');
            const translatableElements = document.querySelectorAll('[data-i18n]');

            // Check localStorage or default to 'it'
            let currentLang = localStorage.getItem('etraweb_lang') || 'it';
            updateLanguage(currentLang);

            langBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const lang = btn.getAttribute('data-lang');
                    if (lang !== currentLang) {
                        currentLang = lang;
                        localStorage.setItem('etraweb_lang', lang);
                        updateLanguage(lang);
                    }
                });
            });

            function updateLanguage(lang) {
                // Update buttons state
                langBtns.forEach(btn => {
                    if (btn.getAttribute('data-lang') === lang) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });

                // Update text content
                translatableElements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (translations[lang] && translations[lang][key]) {
                        // Handle HTML content (for <br> etc)
                        if (translations[lang][key].includes('<')) {
                            el.innerHTML = translations[lang][key];
                        } else {
                            el.innerText = translations[lang][key];
                        }

                        // Update data-text for glitch effect if present
                        if (el.hasAttribute('data-text')) {
                            el.setAttribute('data-text', translations[lang][key]);
                        }
                    }
                });

                // Update html lang attribute
                document.documentElement.lang = lang;
            }

            // --- CONFIGURATION ---
            const CONFIG = {
                scrambleSpeed: 50,
                tiltMax: 15,
                tiltSpeed: 400,
                magneticStrength: 0.5,
                magneticRange: 100,
            };

            // --- AUDIO SYSTEM (Web Audio API) ---
            const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const gainNode = audioCtx.createGain();
            gainNode.connect(audioCtx.destination);
            gainNode.gain.value = 0.1; // Low volume

            const playSound = (type) => {
                if (audioCtx.state === 'suspended') audioCtx.resume();

                const osc = audioCtx.createOscillator();
                const env = audioCtx.createGain();

                osc.connect(env);
                env.connect(gainNode);

                if (type === 'hover') {
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(400, audioCtx.currentTime);
                    osc.frequency.exponentialRampToValueAtTime(800, audioCtx.currentTime + 0.1);
                    env.gain.setValueAtTime(0, audioCtx.currentTime);
                    env.gain.linearRampToValueAtTime(0.5, audioCtx.currentTime + 0.05);
                    env.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
                    osc.start();
                    osc.stop(audioCtx.currentTime + 0.2);
                } else if (type === 'click') {
                    osc.type = 'square';
                    osc.frequency.setValueAtTime(200, audioCtx.currentTime);
                    osc.frequency.exponentialRampToValueAtTime(50, audioCtx.currentTime + 0.1);
                    env.gain.setValueAtTime(0.5, audioCtx.currentTime);
                    env.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
                    osc.start();
                    osc.stop(audioCtx.currentTime + 0.1);
                }
            };

            // --- PRELOADER ---
            const preloader = document.getElementById('preloader');
            const progressBar = document.querySelector('.loader-progress');
            const loaderText = document.querySelector('.loader-text');

            let progress = 0;
            const loadInterval = setInterval(() => {
                progress += Math.random() * 10;
                if (progress > 100) progress = 100;
                progressBar.style.width = `${progress}%`;

                if (progress === 100) {
                    clearInterval(loadInterval);
                    loaderText.innerText = "SYSTEM READY";
                    setTimeout(() => {
                        preloader.style.opacity = '0';
                        preloader.style.visibility = 'hidden';
                        initEntranceAnimations();
                    }, 500);
                }
            }, 80); // Faster load

            function initEntranceAnimations() {
                document.querySelectorAll('.hero-title, .hero-subtitle, .hero-cta').forEach(el => {
                    el.style.animationPlayState = 'running';
                });
            }

            // --- THREE.JS SCENE WITH BLOOM & SHADERS ---
            const initThreeJS = () => {
                const canvas = document.getElementById('bg-canvas');
                if (!canvas) return;

                const scene = new THREE.Scene();
                const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                const renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true, antialias: true });

                renderer.setSize(window.innerWidth, window.innerHeight);
                // OPTIMIZATION: Cap pixel ratio to 1.5 to prevent performance drop on Retina screens with Post-Processing
                renderer.setPixelRatio(Math.min(window.devicePixelRatio, 1.5));
                renderer.toneMapping = THREE.ReinhardToneMapping;

                // POST PROCESSING - BLOOM
                const renderScene = new RenderPass(scene, camera);
                // OPTIMIZATION: Reduce bloom resolution slightly
                const bloomPass = new UnrealBloomPass(new THREE.Vector2(window.innerWidth / 2, window.innerHeight / 2), 1.5, 0.4, 0.85);
                bloomPass.threshold = 0;
                bloomPass.strength = 2.0; // Slightly reduced strength
                bloomPass.radius = 0.5;

                const composer = new EffectComposer(renderer);
                composer.addPass(renderScene);
                composer.addPass(bloomPass);

                // SHADER MATERIAL (Liquid Metal)
                const vertexShader = `
            varying vec2 vUv;
            varying vec3 vPosition;
            uniform float time;
            
            void main() {
                vUv = uv;
                vPosition = position;
                
                // Deform position based on time and noise-like sin waves
                vec3 newPos = position;
                newPos.x += sin(position.y * 4.0 + time) * 0.5;
                newPos.y += cos(position.x * 4.0 + time) * 0.5;
                newPos.z += sin(position.z * 4.0 + time) * 0.5;
                
                gl_Position = projectionMatrix * modelViewMatrix * vec4(newPos, 1.0);
            }
        `;

                const fragmentShader = `
            varying vec2 vUv;
            varying vec3 vPosition;
            uniform float time;
            
            void main() {
                // Create a pulsing neon color pattern
                vec3 color1 = vec3(0.42, 0.16, 0.85); // Purple
                vec3 color2 = vec3(0.23, 0.51, 0.96); // Blue
                
                float noise = sin(vPosition.x * 10.0 + time) * sin(vPosition.y * 10.0 + time);
                vec3 finalColor = mix(color1, color2, noise * 0.5 + 0.5);
                
                // Add "hot" spots
                float glow = smoothstep(0.4, 0.6, noise);
                finalColor += vec3(glow * 0.5);

                gl_FragColor = vec4(finalColor, 0.6); // Semi-transparent
            }
        `;

                const material = new THREE.ShaderMaterial({
                    uniforms: {
                        time: { value: 0 }
                    },
                    vertexShader: vertexShader,
                    fragmentShader: fragmentShader,
                    wireframe: true,
                    transparent: true,
                    side: THREE.DoubleSide
                });

                // OPTIMIZATION: Reduce geometry detail from 4 to 1
                const geometry = new THREE.IcosahedronGeometry(8, 1);
                const sphere = new THREE.Mesh(geometry, material);
                scene.add(sphere);

                // Particles
                const particlesGeometry = new THREE.BufferGeometry();
                // OPTIMIZATION: Reduce particle count from 1000 to 600
                const particlesCount = 600;
                const posArray = new Float32Array(particlesCount * 3);

                for (let i = 0; i < particlesCount * 3; i++) {
                    posArray[i] = (Math.random() - 0.5) * 60;
                }

                particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
                const particlesMaterial = new THREE.PointsMaterial({
                    size: 0.05,
                    color: 0x3b82f6,
                    transparent: true,
                    opacity: 0.8,
                    blending: THREE.AdditiveBlending
                });

                const particlesMesh = new THREE.Points(particlesGeometry, particlesMaterial);
                scene.add(particlesMesh);

                camera.position.z = 20;

                // Interaction
                let mouseX = 0;
                let mouseY = 0;
                let scrollY = 0; // Track scroll position
                const windowHalfX = window.innerWidth / 2;
                const windowHalfY = window.innerHeight / 2;

                document.addEventListener('mousemove', (event) => {
                    mouseX = (event.clientX - windowHalfX);
                    mouseY = (event.clientY - windowHalfY);
                });

                window.addEventListener('scroll', () => {
                    scrollY = window.scrollY;
                });

                const clock = new THREE.Clock();

                const animate = () => {
                    const elapsedTime = clock.getElapsedTime();

                    // Update Shader Uniforms
                    material.uniforms.time.value = elapsedTime;

                    // Rotate sphere based on mouse
                    sphere.rotation.y += 0.05 * (mouseX * 0.001 - sphere.rotation.y);
                    sphere.rotation.x += 0.05 * (mouseY * 0.001 - sphere.rotation.x);

                    // Rotate particles based on mouse AND scroll
                    particlesMesh.rotation.y = -mouseX * 0.0002 + scrollY * 0.0005;
                    particlesMesh.rotation.x = -mouseY * 0.0002 + scrollY * 0.0002;

                    composer.render();
                    requestAnimationFrame(animate);
                };

                animate();

                window.addEventListener('resize', () => {
                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(window.innerWidth, window.innerHeight);
                    composer.setSize(window.innerWidth, window.innerHeight);
                });
            };

            initThreeJS();


            // --- CUSTOM CURSOR & MAGNETIC BUTTONS ---
            const cursorDot = document.querySelector('[data-cursor-dot]');
            const cursorOutline = document.querySelector('[data-cursor-outline]');
            const isTouchDevice = window.matchMedia("(pointer: coarse)").matches;

            if (!isTouchDevice) {
                window.addEventListener('mousemove', (e) => {
                    const posX = e.clientX;
                    const posY = e.clientY;

                    cursorDot.style.left = `${posX}px`;
                    cursorDot.style.top = `${posY}px`;

                    cursorOutline.animate({
                        left: `${posX}px`,
                        top: `${posY}px`
                    }, { duration: 500, fill: "forwards" });
                });

                const magneticBtns = document.querySelectorAll('.btn-primary, .btn-glow, .btn-outline, .nav-link');

                magneticBtns.forEach(btn => {
                    btn.addEventListener('mousemove', (e) => {
                        const rect = btn.getBoundingClientRect();
                        const x = e.clientX - rect.left - rect.width / 2;
                        const y = e.clientY - rect.top - rect.height / 2;

                        btn.style.transform = `translate(${x * 0.3}px, ${y * 0.3}px)`;
                        cursorOutline.style.transform = 'translate(-50%, -50%) scale(1.5)';
                        cursorOutline.style.backgroundColor = 'rgba(255, 255, 255, 0.1)';

                        // Play sound only if not already playing (debounce slightly)
                        if (!btn.dataset.soundPlayed) {
                            playSound('hover');
                            btn.dataset.soundPlayed = "true";
                            setTimeout(() => btn.dataset.soundPlayed = "", 200);
                        }
                    });

                    btn.addEventListener('mouseleave', () => {
                        btn.style.transform = 'translate(0px, 0px)';
                        cursorOutline.style.transform = 'translate(-50%, -50%) scale(1)';
                        cursorOutline.style.backgroundColor = 'transparent';
                    });

                    btn.addEventListener('click', () => {
                        playSound('click');
                    });
                });
            } else {
                cursorDot.style.display = 'none';
                cursorOutline.style.display = 'none';
            }

            // --- TEXT SCRAMBLE ---
            class TextScramble {
                constructor(el) {
                    this.el = el;
                    this.chars = '!<>-_\\/[]{}‚Äî=+*^?#________';
                    this.update = this.update.bind(this);
                }
                setText(newText) {
                    const oldText = this.el.innerText;
                    const length = Math.max(oldText.length, newText.length);
                    const promise = new Promise((resolve) => this.resolve = resolve);
                    this.queue = [];
                    for (let i = 0; i < length; i++) {
                        const from = oldText[i] || '';
                        const to = newText[i] || '';
                        const start = Math.floor(Math.random() * 40);
                        const end = start + Math.floor(Math.random() * 40);
                        this.queue.push({ from, to, start, end });
                    }
                    cancelAnimationFrame(this.frameRequest);
                    this.frame = 0;
                    this.update();
                    return promise;
                }
                update() {
                    let output = '';
                    let complete = 0;
                    for (let i = 0, n = this.queue.length; i < n; i++) {
                        let { from, to, start, end, char } = this.queue[i];
                        if (this.frame >= end) {
                            complete++;
                            output += to;
                        } else if (this.frame >= start) {
                            if (!char || Math.random() < 0.28) {
                                char = this.randomChar();
                                this.queue[i].char = char;
                            }
                            output += `<span class="dud">${char}</span>`;
                        } else {
                            output += from;
                        }
                    }
                    this.el.innerHTML = output;
                    if (complete === this.queue.length) {
                        this.resolve();
                    } else {
                        this.frameRequest = requestAnimationFrame(this.update);
                        this.frame++;
                    }
                }
                randomChar() {
                    return this.chars[Math.floor(Math.random() * this.chars.length)];
                }
            }

            const scrambleObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting && !entry.target.classList.contains('scrambled')) {
                        const el = entry.target;
                        const text = el.innerText;
                        el.setAttribute('data-text', text);
                        el.classList.add('glitch-hover');

                        const scrambler = new TextScramble(el);
                        scrambler.setText(text);
                        el.classList.add('scrambled');
                    }
                });
            }, { threshold: 0.5 });

            document.querySelectorAll('.hero-title, .section-title').forEach(el => {
                scrambleObserver.observe(el);
            });

            // --- 3D TILT ---
            const tiltElements = document.querySelectorAll('.service-card, .portfolio-item, .contact-wrapper');
            tiltElements.forEach(el => {
                el.addEventListener('mousemove', (e) => {
                    const rect = el.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    const centerX = rect.width / 2;
                    const centerY = rect.height / 2;
                    const rotateX = ((y - centerY) / centerY) * -CONFIG.tiltMax;
                    const rotateY = ((x - centerX) / centerX) * CONFIG.tiltMax;

                    el.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(1.02)`;
                });
                el.addEventListener('mouseleave', () => {
                    el.style.transform = `perspective(1000px) rotateX(0) rotateY(0) scale(1)`;
                });
            });

            // --- SCROLL REVEAL ---
            const revealObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('in-view');
                    }
                });
            }, { threshold: 0.1 });

            document.querySelectorAll('.service-card, .portfolio-item, .contact-wrapper').forEach(el => {
                el.classList.add('animate-on-scroll');
                revealObserver.observe(el);
            });

            // --- STATS COUNTER ---
            const statsObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const counters = entry.target.querySelectorAll('.stat-number');
                        counters.forEach(counter => {
                            const target = +counter.getAttribute('data-target');
                            const duration = 2000; // 2 seconds
                            const increment = target / (duration / 16); // 60fps

                            let current = 0;
                            const updateCounter = () => {
                                current += increment;
                                if (current < target) {
                                    counter.innerText = Math.ceil(current) + (target > 90 ? '+' : ''); // Add + for percentages or big numbers if needed, logic can be refined
                                    requestAnimationFrame(updateCounter);
                                } else {
                                    counter.innerText = target + (target === 99 ? '%' : '+'); // Custom formatting
                                }
                            };
                            updateCounter();
                        });
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.5 });

            const statsSection = document.querySelector('.stats-grid');
            if (statsSection) {
                statsObserver.observe(statsSection);
            }

            // --- MOBILE MENU ---
            const mobileBtn = document.querySelector('.mobile-menu-btn');
            const navList = document.querySelector('.nav-list');
            if (mobileBtn) {
                mobileBtn.addEventListener('click', () => {
                    mobileBtn.classList.toggle('active');
                    navList.classList.toggle('active');
                });
            }
        });
    </script>
</body>

</html>